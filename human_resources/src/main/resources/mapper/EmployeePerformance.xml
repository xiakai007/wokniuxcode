<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.isoftstone.humanresources.dao.EmployeePerformanceDao">
    <resultMap id="performanceID"
               type="com.isoftstone.humanresources.domain.EmployeeInformation">
        <result column="employeeID"  property="employeeID" />
        <result column="start_date"  property="startDate" />
        <result column="end_date"  property="endDate" />
        <result column="type"  property="type" />
        <result column="score" property="score" />
        <result column="level" property="level" />
        <result column="maternity_leave"  property="maternityLeave" />
        <result column="is_gt_45" property="isGt45" />
        <result column="is_manage_agreed"  property="isManageAgreed" />
        <result column="remark"  property="remark" />
        <result column="quarter" property="quarter" />
        <result column="year"  property="year" />
    </resultMap>
    <insert id="importExcelEmployeePerformance" parameterType="java.util.List">
        insert into
        t_employee_performance
        (
        employeeID,
        start_date,
        end_date,
        `type`,
        score,
        `level`,
        maternity_leave,
        is_gt_45,
        is_manage_agreed,
        remark,
        quarter,
        `year`
        )
        values
        <foreach collection="list" item="item" index="index"
                 open="" close="" separator=",">
            (
            #{item.employeeID, jdbcType=INTEGER},
            STR_TO_DATE(#{item.startDate, jdbcType=VARCHAR},'%Y-%m-%d'),
            STR_TO_DATE(#{item.endDate, jdbcType=VARCHAR},'%Y-%m-%d'),
            #{item.type, jdbcType=VARCHAR},
            #{item.score, jdbcType=INTEGER},
            #{item.level, jdbcType=VARCHAR},
            #{item.maternityLeave, jdbcType=VARCHAR},
            #{item.isGt45, jdbcType=VARCHAR},
            #{item.isManageAgreed, jdbcType=VARCHAR},
            #{item.remark, jdbcType=VARCHAR},
            #{item.quarter, jdbcType=VARCHAR},
            #{item.year, jdbcType=VARCHAR}
            )
        </foreach>
    </insert>
</mapper>